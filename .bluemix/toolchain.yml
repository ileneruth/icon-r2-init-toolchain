version: 2
template:
  name: ICON r2 Initial Setup Toolchain Template
  description: This Toolchain is for the initial setup.  Each deployment is tagged.
  info:
    git url: '[https://git.ng.bluemix.net/ankitadk/toolchain-moh](https://git.ng.bluemix.net/ankitadk/toolchain-moh)'
    git branch: '[master](https://git.ng.bluemix.net/ankitadk/toolchain-moh/tree/master)'
toolchain:
  name: icon2-initial-setup-toolchain-{{timestamp}}
services:
  icon-r2-server-repo:
    service_id: githubpublic
    parameters:
      repo_url: 'https://github.com/MOHLTC11/icon-r2-backend'
      type: link
      has_issues: false
      enable_traceability: false
  icon-r2-server-pipeline:
    service_id: pipeline
    parameters:
      services:
        - icon-r2-server-repo
      name: 'icon-r2-backend-pipeline'
      configuration:
        content:
          $ref: initial_setup.yml
          $refType: text
        env:
          SAMPLE_REPO: icon-r2-server-repo
          CF_APP_NAME1: '{{form.pipeline.parameters.server-app-name}}'
          CF_APP_NAME2: '{{form.pipeline.parameters.server-worker-app-name}}'
          PROD_SPACE_NAME: '{{form.pipeline.parameters.prod-space}}'
          PROD_ORG_NAME: '{{form.pipeline.parameters.prod-organization}}'
          PROD_REGION_ID: '{{form.pipeline.parameters.prod-region}}'
    execute: false
form:
  pipeline:
    parameters:
      server-app-name: 'icon-r2-server'
    schema:
      $ref: deploy.json
